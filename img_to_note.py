from PIL import Image

test_file_name = 5

im = Image.open(f"images/test_ig_{test_file_name}.png")

pix = im.load()

black = (0, 0, 0, 255)
white = (255, 255, 255, 255)

notes = []

note_dict = {
    ((0, 0, 0, 255), (255, 255, 255, 255), (255, 255, 255, 255), (255, 255, 255, 255)): 'A',
    ((255, 255, 255, 255), (0, 0, 0, 255), (255, 255, 255, 255), (255, 255, 255, 255)): 'A#',
    ((255, 255, 255, 255), (255, 255, 255, 255), (255, 255, 255, 255), (0, 0, 0, 255)): 'B',
    ((255, 255, 255, 255), (255, 255, 255, 255), (0, 0, 0, 255), (255, 255, 255, 255)): 'C',
    ((0, 0, 0, 255), (0, 0, 0, 255), (255, 255, 255, 255), (255, 255, 255, 255)): 'C#',
    ((255, 255, 255, 255), (255, 255, 255, 255), (0, 0, 0, 255), (0, 0, 0, 255)): 'D',
    ((0, 0, 0, 255), (255, 255, 255, 255), (0, 0, 0, 255), (255, 255, 255, 255)): 'D#',
    ((255, 255, 255, 255), (0, 0, 0, 255), (255, 255, 255, 255), (0, 0, 0, 255)): 'E',
    ((255, 255, 255, 255), (0, 0, 0, 255), (0, 0, 0, 255), (0, 0, 0, 255)): 'F',
    ((0, 0, 0, 255), (255, 255, 255, 255), (0, 0, 0, 255), (0, 0, 0, 255)): 'F#',
    ((0, 0, 0, 255), (0, 0, 0, 255), (0, 0, 0, 255), (255, 255, 255, 255)): 'G',
    ((0, 0, 0, 255), (0, 0, 0, 255), (255, 255, 255, 255), (0, 0, 0, 255)): 'G#'
}

x = 0
y = 0


for row in range(int(im.size[1] / 2)):

    for note_block in range(int(im.size[0] / 2)):
        start_x = x
        start_y = y
        array2 = []
        for row in range(2):
            for column in range(2):
                array2.append(pix[x,y])
                x += 1
                if x >= start_x + 2:
                    x -= 2
            y += 1
            if y >= start_y + 2:
                y -= 2 
        notes.append(tuple(array2))
        x += 2
        if x > int(im.size[0]) - 1:
            x = 0
            y += 2


file_name = f'{test_file_name}_'

for note in notes:
    file_name += note_dict[note]
file_name += '.txt'

f = open(file_name, 'w')

for note in notes:
    f.write(note_dict[note] + '\n')
